{"version":3,"sources":["../../client/head-manager.js"],"names":["DOMAttributeNames","acceptCharset","className","htmlFor","httpEquiv","reactElementToDOM","type","props","el","document","createElement","p","hasOwnProperty","undefined","attr","toLowerCase","setAttribute","children","dangerouslySetInnerHTML","innerHTML","__html","textContent","join","updateElements","components","headEl","getElementsByTagName","headCountEl","querySelector","process","env","NODE_ENV","console","error","headCount","Number","content","oldTags","i","j","previousElementSibling","tagName","push","newTags","map","filter","newTag","k","len","length","oldTag","isEqualNode","splice","forEach","t","parentNode","removeChild","insertBefore","toString","initHeadManager","updatePromise","mountedInstances","Set","updateHead","head","promise","Promise","resolve","then","tags","h","titleComponent","title"],"mappings":"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","sourcesContent":["const DOMAttributeNames = {\n  acceptCharset: 'accept-charset',\n  className: 'class',\n  htmlFor: 'for',\n  httpEquiv: 'http-equiv',\n}\n\nfunction reactElementToDOM({ type, props }) {\n  const el = document.createElement(type)\n  for (const p in props) {\n    if (!props.hasOwnProperty(p)) continue\n    if (p === 'children' || p === 'dangerouslySetInnerHTML') continue\n\n    // we don't render undefined props to the DOM\n    if (props[p] === undefined) continue\n\n    const attr = DOMAttributeNames[p] || p.toLowerCase()\n    el.setAttribute(attr, props[p])\n  }\n\n  const { children, dangerouslySetInnerHTML } = props\n  if (dangerouslySetInnerHTML) {\n    el.innerHTML = dangerouslySetInnerHTML.__html || ''\n  } else if (children) {\n    el.textContent = typeof children === 'string' ? children : children.join('')\n  }\n  return el\n}\n\nfunction updateElements(type, components) {\n  const headEl = document.getElementsByTagName('head')[0]\n  const headCountEl = headEl.querySelector('meta[name=next-head-count]')\n  if (process.env.NODE_ENV !== 'production') {\n    if (!headCountEl) {\n      console.error(\n        'Warning: next-head-count is missing. https://err.sh/next.js/next-head-count-missing'\n      )\n      return\n    }\n  }\n\n  const headCount = Number(headCountEl.content)\n  const oldTags = []\n\n  for (\n    let i = 0, j = headCountEl.previousElementSibling;\n    i < headCount;\n    i++, j = j.previousElementSibling\n  ) {\n    if (j.tagName.toLowerCase() === type) {\n      oldTags.push(j)\n    }\n  }\n  const newTags = components.map(reactElementToDOM).filter((newTag) => {\n    for (let k = 0, len = oldTags.length; k < len; k++) {\n      const oldTag = oldTags[k]\n      if (oldTag.isEqualNode(newTag)) {\n        oldTags.splice(k, 1)\n        return false\n      }\n    }\n    return true\n  })\n\n  oldTags.forEach((t) => t.parentNode.removeChild(t))\n  newTags.forEach((t) => headEl.insertBefore(t, headCountEl))\n  headCountEl.content = (headCount - oldTags.length + newTags.length).toString()\n}\n\nexport default function initHeadManager() {\n  let updatePromise = null\n\n  return {\n    mountedInstances: new Set(),\n    updateHead: (head) => {\n      const promise = (updatePromise = Promise.resolve().then(() => {\n        if (promise !== updatePromise) return\n\n        updatePromise = null\n        const tags = {}\n\n        head.forEach((h) => {\n          const components = tags[h.type] || []\n          components.push(h)\n          tags[h.type] = components\n        })\n\n        const titleComponent = tags.title ? tags.title[0] : null\n        let title = ''\n        if (titleComponent) {\n          const { children } = titleComponent.props\n          title = typeof children === 'string' ? children : children.join('')\n        }\n        if (title !== document.title) document.title = title\n        ;['meta', 'base', 'link', 'style', 'script'].forEach((type) => {\n          updateElements(type, tags[type] || [])\n        })\n      }))\n    },\n  }\n}\n"]}