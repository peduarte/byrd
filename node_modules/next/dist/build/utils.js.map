{"version":3,"sources":["../../build/utils.ts"],"names":["fileGzipStats","fsStatGzip","file","gzipSize","collectPages","directory","pageExtensions","RegExp","join","printTreeView","list","pageInfos","serverless","distPath","buildId","pagesDir","buildManifest","isModern","useStatic404","getPrettySize","_size","size","chalk","green","yellow","red","bold","getCleanName","fileName","replace","messages","map","entry","underline","hasCustomApp","set","get","static","includes","sizeData","computeFromManifest","pageList","slice","filter","e","sort","a","b","localeCompare","forEach","item","i","arr","symbol","length","pageInfo","ampFirst","ampFirstPages","push","isSsg","cyan","totalSize","uniqueCssFiles","pages","endsWith","uniqueFiles","contSymbol","index","innerSymbol","sizeUniqueFiles","ssgPageRoutes","totalRoutes","previewPages","routes","remaining","slug","sharedFilesSize","sizeCommonFiles","sharedFiles","sizeCommonFile","sharedFileKeys","Object","keys","sharedCssFiles","originalName","cleanName","console","log","align","stringLength","str","printCustomRoutes","redirects","rewrites","headers","printRoutes","type","isRedirects","isHeaders","routesStr","route","routeStr","source","r","destination","statusCode","permanent","header","last","key","value","cachedBuildManifest","lastCompute","lastComputeModern","lastComputePageInfo","manifest","is","expected","files","Map","isHybridAmp","Infinity","has","commonFiles","entries","len","f","stats","Promise","all","path","_","uniqueStats","reduce","obj","n","assign","stat","difference","main","sub","Set","x","intersect","sum","getJsPageSizeInKb","page","data","fnFilterModern","pageFiles","appFiles","fnMapRealPath","dep","allFilesReal","selfFilesReal","allFilesSize","selfFilesSize","buildStaticPaths","getStaticPaths","prerenderPaths","_routeRegex","_routeMatcher","_validParamKeys","staticPathsResult","expectedReturnVal","Array","isArray","Error","invalidStaticPathKeys","fallback","toPrerender","paths","result","add","invalidKeys","k","params","builtPage","validParamKey","repeat","optional","groups","paramValue","hasOwnProperty","undefined","replaced","escapePathDelimiters","isPageStatic","serverBundle","runtimeEnvConfig","require","setConfig","mod","Comp","default","hasGetInitialProps","getInitialProps","hasStaticProps","getStaticProps","hasStaticPaths","hasServerProps","getServerSideProps","hasLegacyServerProps","unstable_getServerProps","hasLegacyStaticProps","unstable_getStaticProps","hasLegacyStaticPaths","unstable_getStaticPaths","hasLegacyStaticParams","unstable_getStaticParams","SSG_GET_INITIAL_PROPS_CONFLICT","SERVER_PROPS_GET_INIT_PROPS_CONFLICT","SERVER_PROPS_SSG_CONFLICT","pageIsDynamic","prerenderRoutes","prerenderFallback","config","isStatic","amp","isAmpOnly","err","code","hasCustomGetInitialProps","bundle","checkingApp","_app","origGetInitialProps","getNamedExports"],"mappings":"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","sourcesContent":["import '../next-server/server/node-polyfill-fetch'\nimport chalk from 'next/dist/compiled/chalk'\nimport gzipSize from 'next/dist/compiled/gzip-size'\nimport textTable from 'next/dist/compiled/text-table'\nimport path from 'path'\nimport { isValidElementType } from 'react-is'\nimport stripAnsi from 'next/dist/compiled/strip-ansi'\nimport {\n  Redirect,\n  Rewrite,\n  Header,\n  CustomRoutes,\n} from '../lib/load-custom-routes'\nimport {\n  SSG_GET_INITIAL_PROPS_CONFLICT,\n  SERVER_PROPS_GET_INIT_PROPS_CONFLICT,\n  SERVER_PROPS_SSG_CONFLICT,\n} from '../lib/constants'\nimport prettyBytes from '../lib/pretty-bytes'\nimport { recursiveReadDir } from '../lib/recursive-readdir'\nimport { getRouteMatcher, getRouteRegex } from '../next-server/lib/router/utils'\nimport { isDynamicRoute } from '../next-server/lib/router/utils/is-dynamic'\nimport escapePathDelimiters from '../next-server/lib/router/utils/escape-path-delimiters'\nimport { findPageFile } from '../server/lib/find-page-file'\nimport { GetStaticPaths } from 'next/types'\nimport { denormalizePagePath } from '../next-server/server/normalize-page-path'\nimport { BuildManifest } from '../next-server/server/get-page-files'\nimport { removePathTrailingSlash } from '../client/normalize-trailing-slash'\n\nconst fileGzipStats: { [k: string]: Promise<number> } = {}\nconst fsStatGzip = (file: string) => {\n  if (fileGzipStats[file]) return fileGzipStats[file]\n  fileGzipStats[file] = gzipSize.file(file)\n  return fileGzipStats[file]\n}\n\nexport function collectPages(\n  directory: string,\n  pageExtensions: string[]\n): Promise<string[]> {\n  return recursiveReadDir(\n    directory,\n    new RegExp(`\\\\.(?:${pageExtensions.join('|')})$`)\n  )\n}\n\nexport interface PageInfo {\n  isHybridAmp?: boolean\n  size: number\n  totalSize: number\n  static: boolean\n  isSsg: boolean\n  ssgPageRoutes: string[] | null\n  hasSsgFallback: boolean\n}\n\nexport async function printTreeView(\n  list: readonly string[],\n  pageInfos: Map<string, PageInfo>,\n  serverless: boolean,\n  {\n    distPath,\n    buildId,\n    pagesDir,\n    pageExtensions,\n    buildManifest,\n    isModern,\n    useStatic404,\n  }: {\n    distPath: string\n    buildId: string\n    pagesDir: string\n    pageExtensions: string[]\n    buildManifest: BuildManifest\n    isModern: boolean\n    useStatic404: boolean\n  }\n) {\n  const getPrettySize = (_size: number): string => {\n    const size = prettyBytes(_size)\n    // green for 0-130kb\n    if (_size < 130 * 1000) return chalk.green(size)\n    // yellow for 130-170kb\n    if (_size < 170 * 1000) return chalk.yellow(size)\n    // red for >= 170kb\n    return chalk.red.bold(size)\n  }\n\n  const getCleanName = (fileName: string) =>\n    fileName\n      // Trim off `static/`\n      .replace(/^static\\//, '')\n      // Re-add `static/` for root files\n      .replace(/^<buildId>/, 'static')\n      // Remove file hash\n      .replace(/[.-]([0-9a-z]{6})[0-9a-z]{14}(?=\\.)/, '.$1')\n\n  const messages: [string, string, string][] = [\n    ['Page', 'Size', 'First Load JS'].map((entry) =>\n      chalk.underline(entry)\n    ) as [string, string, string],\n  ]\n\n  const hasCustomApp = await findPageFile(pagesDir, '/_app', pageExtensions)\n\n  pageInfos.set('/404', {\n    ...(pageInfos.get('/404') || pageInfos.get('/_error')),\n    static: useStatic404,\n  } as any)\n\n  if (!list.includes('/404')) {\n    list = [...list, '/404']\n  }\n\n  const sizeData = await computeFromManifest(\n    buildManifest,\n    distPath,\n    isModern,\n    pageInfos\n  )\n\n  const pageList = list\n    .slice()\n    .filter(\n      (e) =>\n        !(\n          e === '/_document' ||\n          e === '/_error' ||\n          (!hasCustomApp && e === '/_app')\n        )\n    )\n    .sort((a, b) => a.localeCompare(b))\n\n  pageList.forEach((item, i, arr) => {\n    const symbol =\n      i === 0\n        ? arr.length === 1\n          ? '─'\n          : '┌'\n        : i === arr.length - 1\n        ? '└'\n        : '├'\n\n    const pageInfo = pageInfos.get(item)\n    const ampFirst = buildManifest.ampFirstPages.includes(item)\n\n    messages.push([\n      `${symbol} ${\n        item === '/_app'\n          ? ' '\n          : pageInfo?.static\n          ? '○'\n          : pageInfo?.isSsg\n          ? '●'\n          : 'λ'\n      } ${item}`,\n      pageInfo\n        ? ampFirst\n          ? chalk.cyan('AMP')\n          : pageInfo.size >= 0\n          ? prettyBytes(pageInfo.size)\n          : ''\n        : '',\n      pageInfo\n        ? ampFirst\n          ? chalk.cyan('AMP')\n          : pageInfo.size >= 0\n          ? getPrettySize(pageInfo.totalSize)\n          : ''\n        : '',\n    ])\n\n    const uniqueCssFiles =\n      buildManifest.pages[item]?.filter(\n        (file) => file.endsWith('.css') && sizeData.uniqueFiles.includes(file)\n      ) || []\n\n    if (uniqueCssFiles.length > 0) {\n      const contSymbol = i === arr.length - 1 ? ' ' : '├'\n\n      uniqueCssFiles.forEach((file, index, { length }) => {\n        const innerSymbol = index === length - 1 ? '└' : '├'\n        messages.push([\n          `${contSymbol}   ${innerSymbol} ${getCleanName(file)}`,\n          prettyBytes(sizeData.sizeUniqueFiles[file]),\n          '',\n        ])\n      })\n    }\n\n    if (pageInfo?.ssgPageRoutes?.length) {\n      const totalRoutes = pageInfo.ssgPageRoutes.length\n      const previewPages = totalRoutes === 4 ? 4 : 3\n      const contSymbol = i === arr.length - 1 ? ' ' : '├'\n\n      const routes = pageInfo.ssgPageRoutes.slice(0, previewPages)\n      if (totalRoutes > previewPages) {\n        const remaining = totalRoutes - previewPages\n        routes.push(`[+${remaining} more paths]`)\n      }\n\n      routes.forEach((slug, index, { length }) => {\n        const innerSymbol = index === length - 1 ? '└' : '├'\n        messages.push([`${contSymbol}   ${innerSymbol} ${slug}`, '', ''])\n      })\n    }\n  })\n\n  const sharedFilesSize = sizeData.sizeCommonFiles\n  const sharedFiles = sizeData.sizeCommonFile\n\n  messages.push([\n    '+ First Load JS shared by all',\n    getPrettySize(sharedFilesSize),\n    '',\n  ])\n  const sharedFileKeys = Object.keys(sharedFiles)\n  const sharedCssFiles: string[] = []\n  ;[\n    ...sharedFileKeys\n      .filter((file) => {\n        if (file.endsWith('.css')) {\n          sharedCssFiles.push(file)\n          return false\n        }\n        return true\n      })\n      .map((e) => e.replace(buildId, '<buildId>'))\n      .sort(),\n    ...sharedCssFiles.map((e) => e.replace(buildId, '<buildId>')).sort(),\n  ].forEach((fileName, index, { length }) => {\n    const innerSymbol = index === length - 1 ? '└' : '├'\n\n    const originalName = fileName.replace('<buildId>', buildId)\n    const cleanName = getCleanName(fileName)\n\n    messages.push([\n      `  ${innerSymbol} ${cleanName}`,\n      prettyBytes(sharedFiles[originalName]),\n      '',\n    ])\n  })\n\n  console.log(\n    textTable(messages, {\n      align: ['l', 'l', 'r'],\n      stringLength: (str) => stripAnsi(str).length,\n    })\n  )\n\n  console.log()\n  console.log(\n    textTable(\n      [\n        [\n          'λ',\n          serverless ? '(Lambda)' : '(Server)',\n          `server-side renders at runtime (uses ${chalk.cyan(\n            'getInitialProps'\n          )} or ${chalk.cyan('getServerSideProps')})`,\n        ],\n        [\n          '○',\n          '(Static)',\n          'automatically rendered as static HTML (uses no initial props)',\n        ],\n        [\n          '●',\n          '(SSG)',\n          `automatically generated as static HTML + JSON (uses ${chalk.cyan(\n            'getStaticProps'\n          )})`,\n        ],\n      ] as [string, string, string][],\n      {\n        align: ['l', 'l', 'l'],\n        stringLength: (str) => stripAnsi(str).length,\n      }\n    )\n  )\n\n  console.log()\n}\n\nexport function printCustomRoutes({\n  redirects,\n  rewrites,\n  headers,\n}: CustomRoutes) {\n  const printRoutes = (\n    routes: Redirect[] | Rewrite[] | Header[],\n    type: 'Redirects' | 'Rewrites' | 'Headers'\n  ) => {\n    const isRedirects = type === 'Redirects'\n    const isHeaders = type === 'Headers'\n    console.log(chalk.underline(type))\n    console.log()\n\n    /*\n        ┌ source\n        ├ permanent/statusCode\n        └ destination\n     */\n    const routesStr = (routes as any[])\n      .map((route: { source: string }) => {\n        let routeStr = `┌ source: ${route.source}\\n`\n\n        if (!isHeaders) {\n          const r = route as Rewrite\n          routeStr += `${isRedirects ? '├' : '└'} destination: ${\n            r.destination\n          }\\n`\n        }\n        if (isRedirects) {\n          const r = route as Redirect\n          routeStr += `└ ${\n            r.statusCode\n              ? `status: ${r.statusCode}`\n              : `permanent: ${r.permanent}`\n          }\\n`\n        }\n\n        if (isHeaders) {\n          const r = route as Header\n          routeStr += `└ headers:\\n`\n\n          for (let i = 0; i < r.headers.length; i++) {\n            const header = r.headers[i]\n            const last = i === headers.length - 1\n\n            routeStr += `  ${last ? '└' : '├'} ${header.key}: ${header.value}\\n`\n          }\n        }\n\n        return routeStr\n      })\n      .join('\\n')\n\n    console.log(routesStr, '\\n')\n  }\n\n  if (redirects.length) {\n    printRoutes(redirects, 'Redirects')\n  }\n  if (rewrites.length) {\n    printRoutes(rewrites, 'Rewrites')\n  }\n  if (headers.length) {\n    printRoutes(headers, 'Headers')\n  }\n}\n\ntype ComputeManifestShape = {\n  commonFiles: string[]\n  uniqueFiles: string[]\n  sizeUniqueFiles: { [file: string]: number }\n  sizeCommonFile: { [file: string]: number }\n  sizeCommonFiles: number\n}\n\nlet cachedBuildManifest: BuildManifest | undefined\n\nlet lastCompute: ComputeManifestShape | undefined\nlet lastComputeModern: boolean | undefined\nlet lastComputePageInfo: boolean | undefined\n\nasync function computeFromManifest(\n  manifest: BuildManifest,\n  distPath: string,\n  isModern: boolean,\n  pageInfos?: Map<string, PageInfo>\n): Promise<ComputeManifestShape> {\n  if (\n    Object.is(cachedBuildManifest, manifest) &&\n    lastComputeModern === isModern &&\n    lastComputePageInfo === !!pageInfos\n  ) {\n    return lastCompute!\n  }\n\n  let expected = 0\n  const files = new Map<string, number>()\n  Object.keys(manifest.pages).forEach((key) => {\n    if (pageInfos) {\n      const pageInfo = pageInfos.get(key)\n      // don't include AMP pages since they don't rely on shared bundles\n      // AMP First pages are not under the pageInfos key\n      if (pageInfo?.isHybridAmp) {\n        return\n      }\n    }\n\n    ++expected\n    manifest.pages[key].forEach((file) => {\n      if (\n        // Select Modern or Legacy scripts\n        file.endsWith('.module.js') !== isModern\n      ) {\n        return\n      }\n\n      if (key === '/_app') {\n        files.set(file, Infinity)\n      } else if (files.has(file)) {\n        files.set(file, files.get(file)! + 1)\n      } else {\n        files.set(file, 1)\n      }\n    })\n  })\n\n  const commonFiles = [...files.entries()]\n    .filter(([, len]) => len === expected || len === Infinity)\n    .map(([f]) => f)\n  const uniqueFiles = [...files.entries()]\n    .filter(([, len]) => len === 1)\n    .map(([f]) => f)\n\n  let stats: [string, number][]\n  try {\n    stats = await Promise.all(\n      commonFiles.map(\n        async (f) =>\n          [f, await fsStatGzip(path.join(distPath, f))] as [string, number]\n      )\n    )\n  } catch (_) {\n    stats = []\n  }\n\n  let uniqueStats: [string, number][]\n  try {\n    uniqueStats = await Promise.all(\n      uniqueFiles.map(\n        async (f) =>\n          [f, await fsStatGzip(path.join(distPath, f))] as [string, number]\n      )\n    )\n  } catch (_) {\n    uniqueStats = []\n  }\n\n  lastCompute = {\n    commonFiles,\n    uniqueFiles,\n    sizeUniqueFiles: uniqueStats.reduce(\n      (obj, n) => Object.assign(obj, { [n[0]]: n[1] }),\n      {}\n    ),\n    sizeCommonFile: stats.reduce(\n      (obj, n) => Object.assign(obj, { [n[0]]: n[1] }),\n      {}\n    ),\n    sizeCommonFiles: stats.reduce((size, [f, stat]) => {\n      if (f.endsWith('.css')) return size\n      return size + stat\n    }, 0),\n  }\n\n  cachedBuildManifest = manifest\n  lastComputeModern = isModern\n  lastComputePageInfo = !!pageInfos\n  return lastCompute!\n}\n\nfunction difference<T>(main: T[], sub: T[]): T[] {\n  const a = new Set(main)\n  const b = new Set(sub)\n  return [...a].filter((x) => !b.has(x))\n}\n\nfunction intersect<T>(main: T[], sub: T[]): T[] {\n  const a = new Set(main)\n  const b = new Set(sub)\n  return [...new Set([...a].filter((x) => b.has(x)))]\n}\n\nfunction sum(a: number[]): number {\n  return a.reduce((size, stat) => size + stat, 0)\n}\n\nexport async function getJsPageSizeInKb(\n  page: string,\n  distPath: string,\n  buildManifest: BuildManifest,\n  isModern: boolean\n): Promise<[number, number]> {\n  const data = await computeFromManifest(buildManifest, distPath, isModern)\n\n  const fnFilterModern = (entry: string) =>\n    entry.endsWith('.js') && entry.endsWith('.module.js') === isModern\n\n  const pageFiles = (\n    buildManifest.pages[denormalizePagePath(page)] || []\n  ).filter(fnFilterModern)\n  const appFiles = (buildManifest.pages['/_app'] || []).filter(fnFilterModern)\n\n  const fnMapRealPath = (dep: string) => `${distPath}/${dep}`\n\n  const allFilesReal = [...new Set([...pageFiles, ...appFiles])].map(\n    fnMapRealPath\n  )\n  const selfFilesReal = difference(\n    intersect(pageFiles, data.uniqueFiles),\n    data.commonFiles\n  ).map(fnMapRealPath)\n\n  try {\n    // Doesn't use `Promise.all`, as we'd double compute duplicate files. This\n    // function is memoized, so the second one will instantly resolve.\n    const allFilesSize = sum(await Promise.all(allFilesReal.map(fsStatGzip)))\n    const selfFilesSize = sum(await Promise.all(selfFilesReal.map(fsStatGzip)))\n\n    return [selfFilesSize, allFilesSize]\n  } catch (_) {}\n  return [-1, -1]\n}\n\nexport async function buildStaticPaths(\n  page: string,\n  getStaticPaths: GetStaticPaths\n): Promise<{ paths: string[]; fallback: boolean }> {\n  const prerenderPaths = new Set<string>()\n  const _routeRegex = getRouteRegex(page)\n  const _routeMatcher = getRouteMatcher(_routeRegex)\n\n  // Get the default list of allowed params.\n  const _validParamKeys = Object.keys(_routeMatcher(page))\n\n  const staticPathsResult = await getStaticPaths()\n\n  const expectedReturnVal =\n    `Expected: { paths: [], fallback: boolean }\\n` +\n    `See here for more info: https://err.sh/vercel/next.js/invalid-getstaticpaths-value`\n\n  if (\n    !staticPathsResult ||\n    typeof staticPathsResult !== 'object' ||\n    Array.isArray(staticPathsResult)\n  ) {\n    throw new Error(\n      `Invalid value returned from getStaticPaths in ${page}. Received ${typeof staticPathsResult} ${expectedReturnVal}`\n    )\n  }\n\n  const invalidStaticPathKeys = Object.keys(staticPathsResult).filter(\n    (key) => !(key === 'paths' || key === 'fallback')\n  )\n\n  if (invalidStaticPathKeys.length > 0) {\n    throw new Error(\n      `Extra keys returned from getStaticPaths in ${page} (${invalidStaticPathKeys.join(\n        ', '\n      )}) ${expectedReturnVal}`\n    )\n  }\n\n  if (typeof staticPathsResult.fallback !== 'boolean') {\n    throw new Error(\n      `The \\`fallback\\` key must be returned from getStaticPaths in ${page}.\\n` +\n        expectedReturnVal\n    )\n  }\n\n  const toPrerender = staticPathsResult.paths\n\n  if (!Array.isArray(toPrerender)) {\n    throw new Error(\n      `Invalid \\`paths\\` value returned from getStaticProps in ${page}.\\n` +\n        `\\`paths\\` must be an array of strings or objects of shape { params: [key: string]: string }`\n    )\n  }\n\n  toPrerender.forEach((entry) => {\n    // For a string-provided path, we must make sure it matches the dynamic\n    // route.\n    if (typeof entry === 'string') {\n      entry = removePathTrailingSlash(entry)\n      const result = _routeMatcher(entry)\n      if (!result) {\n        throw new Error(\n          `The provided path \\`${entry}\\` does not match the page: \\`${page}\\`.`\n        )\n      }\n\n      prerenderPaths?.add(entry)\n    }\n    // For the object-provided path, we must make sure it specifies all\n    // required keys.\n    else {\n      const invalidKeys = Object.keys(entry).filter((key) => key !== 'params')\n      if (invalidKeys.length) {\n        throw new Error(\n          `Additional keys were returned from \\`getStaticPaths\\` in page \"${page}\". ` +\n            `URL Parameters intended for this dynamic route must be nested under the \\`params\\` key, i.e.:` +\n            `\\n\\n\\treturn { params: { ${_validParamKeys\n              .map((k) => `${k}: ...`)\n              .join(', ')} } }` +\n            `\\n\\nKeys that need to be moved: ${invalidKeys.join(', ')}.\\n`\n        )\n      }\n\n      const { params = {} } = entry\n      let builtPage = page\n      _validParamKeys.forEach((validParamKey) => {\n        const { repeat, optional } = _routeRegex.groups[validParamKey]\n        let paramValue = params[validParamKey]\n        if (\n          optional &&\n          params.hasOwnProperty(validParamKey) &&\n          (paramValue === null ||\n            paramValue === undefined ||\n            (paramValue as any) === false)\n        ) {\n          paramValue = []\n        }\n        if (\n          (repeat && !Array.isArray(paramValue)) ||\n          (!repeat && typeof paramValue !== 'string')\n        ) {\n          throw new Error(\n            `A required parameter (${validParamKey}) was not provided as ${\n              repeat ? 'an array' : 'a string'\n            } in getStaticPaths for ${page}`\n          )\n        }\n        let replaced = `[${repeat ? '...' : ''}${validParamKey}]`\n        if (optional) {\n          replaced = `[${replaced}]`\n        }\n        builtPage = builtPage\n          .replace(\n            replaced,\n            repeat\n              ? (paramValue as string[]).map(escapePathDelimiters).join('/')\n              : escapePathDelimiters(paramValue as string)\n          )\n          .replace(/(?!^)\\/$/, '')\n      })\n\n      prerenderPaths?.add(builtPage)\n    }\n  })\n\n  return { paths: [...prerenderPaths], fallback: staticPathsResult.fallback }\n}\n\nexport async function isPageStatic(\n  page: string,\n  serverBundle: string,\n  runtimeEnvConfig: any\n): Promise<{\n  isStatic?: boolean\n  isAmpOnly?: boolean\n  isHybridAmp?: boolean\n  hasServerProps?: boolean\n  hasStaticProps?: boolean\n  prerenderRoutes?: string[] | undefined\n  prerenderFallback?: boolean | undefined\n}> {\n  try {\n    require('../next-server/lib/runtime-config').setConfig(runtimeEnvConfig)\n    const mod = require(serverBundle)\n    const Comp = mod.default || mod\n\n    if (!Comp || !isValidElementType(Comp) || typeof Comp === 'string') {\n      throw new Error('INVALID_DEFAULT_EXPORT')\n    }\n\n    const hasGetInitialProps = !!(Comp as any).getInitialProps\n    const hasStaticProps = !!mod.getStaticProps\n    const hasStaticPaths = !!mod.getStaticPaths\n    const hasServerProps = !!mod.getServerSideProps\n    const hasLegacyServerProps = !!mod.unstable_getServerProps\n    const hasLegacyStaticProps = !!mod.unstable_getStaticProps\n    const hasLegacyStaticPaths = !!mod.unstable_getStaticPaths\n    const hasLegacyStaticParams = !!mod.unstable_getStaticParams\n\n    if (hasLegacyStaticParams) {\n      throw new Error(\n        `unstable_getStaticParams was replaced with getStaticPaths. Please update your code.`\n      )\n    }\n\n    if (hasLegacyStaticPaths) {\n      throw new Error(\n        `unstable_getStaticPaths was replaced with getStaticPaths. Please update your code.`\n      )\n    }\n\n    if (hasLegacyStaticProps) {\n      throw new Error(\n        `unstable_getStaticProps was replaced with getStaticProps. Please update your code.`\n      )\n    }\n\n    if (hasLegacyServerProps) {\n      throw new Error(\n        `unstable_getServerProps was replaced with getServerSideProps. Please update your code.`\n      )\n    }\n\n    // A page cannot be prerendered _and_ define a data requirement. That's\n    // contradictory!\n    if (hasGetInitialProps && hasStaticProps) {\n      throw new Error(SSG_GET_INITIAL_PROPS_CONFLICT)\n    }\n\n    if (hasGetInitialProps && hasServerProps) {\n      throw new Error(SERVER_PROPS_GET_INIT_PROPS_CONFLICT)\n    }\n\n    if (hasStaticProps && hasServerProps) {\n      throw new Error(SERVER_PROPS_SSG_CONFLICT)\n    }\n\n    const pageIsDynamic = isDynamicRoute(page)\n    // A page cannot have static parameters if it is not a dynamic page.\n    if (hasStaticProps && hasStaticPaths && !pageIsDynamic) {\n      throw new Error(\n        `getStaticPaths can only be used with dynamic pages, not '${page}'.` +\n          `\\nLearn more: https://nextjs.org/docs/routing/dynamic-routes`\n      )\n    }\n\n    if (hasStaticProps && pageIsDynamic && !hasStaticPaths) {\n      throw new Error(\n        `getStaticPaths is required for dynamic SSG pages and is missing for '${page}'.` +\n          `\\nRead more: https://err.sh/next.js/invalid-getstaticpaths-value`\n      )\n    }\n\n    let prerenderRoutes: Array<string> | undefined\n    let prerenderFallback: boolean | undefined\n    if (hasStaticProps && hasStaticPaths) {\n      ;({\n        paths: prerenderRoutes,\n        fallback: prerenderFallback,\n      } = await buildStaticPaths(page, mod.getStaticPaths))\n    }\n\n    const config = mod.config || {}\n    return {\n      isStatic: !hasStaticProps && !hasGetInitialProps && !hasServerProps,\n      isHybridAmp: config.amp === 'hybrid',\n      isAmpOnly: config.amp === true,\n      prerenderRoutes,\n      prerenderFallback,\n      hasStaticProps,\n      hasServerProps,\n    }\n  } catch (err) {\n    if (err.code === 'MODULE_NOT_FOUND') return {}\n    throw err\n  }\n}\n\nexport function hasCustomGetInitialProps(\n  bundle: string,\n  runtimeEnvConfig: any,\n  checkingApp: boolean\n): boolean {\n  require('../next-server/lib/runtime-config').setConfig(runtimeEnvConfig)\n  let mod = require(bundle)\n\n  if (checkingApp) {\n    mod = mod._app || mod.default || mod\n  } else {\n    mod = mod.default || mod\n  }\n  return mod.getInitialProps !== mod.origGetInitialProps\n}\n\nexport function getNamedExports(\n  bundle: string,\n  runtimeEnvConfig: any\n): Array<string> {\n  require('../next-server/lib/runtime-config').setConfig(runtimeEnvConfig)\n  return Object.keys(require(bundle))\n}\n"]}